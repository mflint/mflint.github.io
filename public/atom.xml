<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Matthew's Dev Blog]]></title>
  <link href="http://tthew.org/atom.xml" rel="self"/>
  <link href="http://tthew.org/"/>
  <updated>2017-09-02T18:01:28+01:00</updated>
  <id>http://tthew.org/</id>
  <author>
    <name><![CDATA[Matthew Flint]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Introduction to hacking iOS apps (part 2)]]></title>
    <link href="http://tthew.org/ios-hacking-2/"/>
    <updated>2017-09-02T12:12:00+01:00</updated>
    <id>http://tthew.org/introduction-to-hacking-ios-apps-part-2</id>
    <content type="html"><![CDATA[<p>In this second part of the &ldquo;hacking iOS apps&rdquo; series, we&rsquo;ll perform some post-jailbreak steps - ready for remote-debugging apps on a jailbroken device.</p>

<!-- more -->


<blockquote><p>This is part 2 of a multi-part series:</p>

<ul>
<li><a href="http://tthew.org/ios-hacking-1/">Part 1</a>: obtaining and jailbreaking a device</li>
<li>Part 2: post-jailbreak stuff</li>
</ul>
</blockquote>

<h3>Recap</h3>

<p>In the <a href="http://tthew.org/ios-hacking-1/">first part of this series</a>, we acquired and jailbroke an iOS device. In part 2, we&rsquo;ll perform some updates and install necessary tools onto the device.</p>

<p>Remember that you may need to re-jailbreak your device every time it boots from cold.</p>

<h3>Cydia updates</h3>

<p>When you start Cydia for the first time, you&rsquo;ll probably be prompted to perform an <em>Essential Upgrade</em>. I&rsquo;d go for the &ldquo;Complete Upgrade&rdquo;; Cydia will kill itself when this is complete.</p>

<p>Next, we&rsquo;ll access the device over <em>ssh</em>.</p>

<h3>ssh access over WiFi</h3>

<p>The yalu jailbreak already includes the <a href="https://matt.ucc.asn.au/dropbear/dropbear.html">Dropbear</a> ssh server, so no need to install <em>OpenSSH</em>. By default, the server is only enabled over USB - so we&rsquo;ll need to change the config to allow this over WiFi.</p>

<ul>
<li>use Cydia to install &ldquo;Filza File Manager&rdquo; app</li>
<li>open Filza, and find &ldquo;/private/var/containers/Bundle/Application/yalu102/yalu102.app/dropbear.plist&rdquo;</li>
<li>use the (i) button to change &ldquo;OPen with&rdquo; to &ldquo;Text Editor&rdquo;, then tap &ldquo;dropbear.plist&rdquo; to edit it</li>
<li>find <code>127.0.0.1:22</code> and replace it with <code>22</code> (this binds the dropbear ssh daemon to all network interfaces, instead of the default which just uses loopback)</li>
<li>reboot the device (and re-jailbreak if necessary)</li>
<li>you should be able to ssh to the device

<ul>
<li><code>ssh root@{ip-address}</code></li>
<li>password <code>alpine</code></li>
</ul>
</li>
<li>now&rsquo;s a great time to change the root password

<ul>
<li><code>passwd</code></li>
</ul>
</li>
<li>and also change the password for the user &ldquo;mobile&rdquo;, which is used for running most apps

<ul>
<li><code>passwd mobile</code></li>
</ul>
</li>
</ul>


<h3>debugserver</h3>

<p>In order to debug applications running on the device, we&rsquo;ll to install need the <code>debugserver</code> tool. This is dead easy to do - Xcode can install it for us.</p>

<ul>
<li>open Xcode and create a new project</li>
<li>make sure the deployment target is low enough to run on the device</li>
<li>debug the new app on the device</li>
<li>Xcode will install <code>debugserver</code> for you</li>
<li>check it&rsquo;s installed on the device:

<ul>
<li><code>ls -l /Developer/usr/bin/debugserver</code></li>
</ul>
</li>
</ul>


<p>Next time: we&rsquo;ll debug a running app, and make some runtime changes.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Introduction to hacking iOS apps (part 1)]]></title>
    <link href="http://tthew.org/ios-hacking-1/"/>
    <updated>2017-09-02T09:30:56+01:00</updated>
    <id>http://tthew.org/introduction-to-hacking-ios-apps-part-1</id>
    <content type="html"><![CDATA[<p>There are several steps to hacking iOS apps, and I aim to cover them over a series of blog posts.</p>

<ol>
<li>Acquiring and jailbreaking an iOS device</li>
<li>Installing necessary tools</li>
<li>Analysing third-party apps</li>
<li>Changing functionality</li>
</ol>


<p>In this first post, we&rsquo;ll acquire and jailbreak an iOS device.</p>

<!-- more -->


<blockquote><p>This is part 1 of a multi-part series:</p>

<ul>
<li>Part 1: obtaining and jailbreaking a device</li>
<li><a href="http://tthew.org/ios-hacking-2/">Part 2</a>: post-jailbreak stuff</li>
</ul>
</blockquote>

<h3>Acquiring a suitable iOS device</h3>

<p>First, some warnings:</p>

<ul>
<li>Don&rsquo;t do this on your primary iOS device - get a separate device to jailbreak</li>
<li>Don&rsquo;t put personal stuff on this jailbroken device. That means:

<ul>
<li>Keep this device away from your email accounts</li>
<li>Turn off iCloud syncing, iMessage, Facetime, etc</li>
<li>Don&rsquo;t access your bank accounts, PayPal, etc from this device</li>
<li>Ideally, use a separate Apple account for this device</li>
</ul>
</li>
</ul>


<p>Finding a suitable device isn&rsquo;t easy. Latest versions of iOS (10.3.3 at the time of writing) cannot be jailbroken, and devices cannot (usually) be reverted to a previous version of iOS. So you&rsquo;ll need to buy a device which is already running an old version of iOS.</p>

<p><a href="https://www.theiphonewiki.com/wiki/Jailbreak" title="the iPhone wiki">the iPhone wiki</a> has a handly list of jailbreakable devices and iOS versions.</p>

<p>There are two places where I&rsquo;d look to find a device for jailbreaking: eBay and high-street <em>cash converter</em> shops.</p>

<h3>Buying a device on eBay</h3>

<p>This is the cheaper option, but you need patience to find the right device. Most sellers will update the device to the latest version of iOS before listing the item on eBay. You can learn a lot from the photos attached to the listing.</p>

<p><strong>Best case scenario</strong>: there&rsquo;s a photo of the <em>About</em> screen, because some sellers think that buyers like to see the device&rsquo;s IMEI. On that screen you can also see the iOS version</p>

<p><strong>Not-so-good scenario</strong>: there are no photos of the device powered-on - you&rsquo;ll need to message the seller to ask them which version it&rsquo;s running. Don&rsquo;t expect to get a good reply - sellers often don&rsquo;t know, or they might guess</p>

<p><strong>Worst-case scenario</strong>: the phone has been factory-reset (photos show the initial iOS <em>Hello</em> screen). In this case, it&rsquo;s not easy for the seller to check the iOS version</p>

<h3>Buying a device at &ldquo;cash converters&rdquo;</h3>

<p>You know <em>cash converters</em> - they&rsquo;re everywhere. Shop-windows full of pre-owned phones and tablets; bins inside the shop containing used DVDs and emoji-poop cushions.</p>

<p>These are better than eBay for many reasons: you can handle the devices and check them for yourself, and they are less likely to be updated to the latest version of iOS. If you speak nicely to the manager, they might check all the phones for you, if they think they&rsquo;ll get an easy sale. Explain that you don&rsquo;t care about dents, scratches and carrier-locks. The only down-side is devices here will be slightly more expensive than on eBay.</p>

<p>I bought a 16Gb iPhone 5s from a high-street store, running iOS 10.1.1.</p>

<h3>Preparing for jailbreak</h3>

<p>First, you&rsquo;ll need to take precautions against automatic iOS updates. If the latest version of iOS is automatically installed, your jailbreak is toast. So I fill the device with empty videos:</p>

<ul>
<li>disable iCloud Photo Libaray (otherwise the device will try to free space by uploading these images to iCloud - but <em>we want</em> the device to be almost full)</li>
<li>open the camera app and record a 10-minute video</li>
<li>open the photos app and duplicate this video multiple times, until your device has less than 700 MB free memory</li>
<li>this means that the device won&rsquo;t have enough space to download iOS updates

<ul>
<li>to check: go to the <em>General -> Software Updates</em> part of the <em>Settings</em> app</li>
<li>you should see the message <em>&ldquo;This update cannot be installed because it requies at least XXX MB of available storage&rdquo;</em>.</li>
</ul>
</li>
<li>you&rsquo;ll need to keep an eye on the available storage - duplicating videos to intentionally use space, deleting videos to free up a little space</li>
<li>each copy of the 10-minute video is around 150 MB on my device</li>
</ul>


<h3>Perform jailbreak</h3>

<p>Next go back to <a href="https://www.theiphonewiki.com/wiki/Jailbreak" title="the iPhone wiki">the iPhone wiki</a> to check which jailbreak to use for your device. For my iOS 10.1.1 iPhone 5s I&rsquo;ll use <a href="https://yalu.qwertyoruiop.com" title="yalu102 beta 7">yalu 102 beta 7</a>, installed with Jay Freeman&rsquo;s <a href="http://www.cydiaimpactor.com" title="Cydia Impactor">Cydia Impactor</a>.</p>

<ul>
<li>download yalu102 and Cydia Impactor</li>
<li>install Cydia Impactor</li>
<li>attach your device</li>
<li>run Cydia Impactor and make sure the device is selected in the top selectbox</li>
<li>drag the yalu IPA to Cydia Impactor</li>
<li>enter your Apple Developer credentials (you may need a application-specific password if you use 2FA - which you should be doing)</li>
<li>yalu102 will be signed with your developer signing identity, and installed on the device</li>
<li>launch yalu102 app on the device</li>
<li>press <strong>go</strong></li>
<li>device will restart</li>
<li>when it has restarted, you&rsquo;ll find the Cydia app installed too</li>
<li>since this is a semi-untethered jailbreak tool, you&rsquo;ll need to run yalu102 to re-jailbreak every time the device boots</li>
</ul>


<p>That&rsquo;s enough for this post. In <a href="http://tthew.org/ios-hacking-2/">the next post</a>, we&rsquo;ll install some necessary tools onto the device.</p>
]]></content>
  </entry>
  
</feed>
